
<div ng-controller="searchbox">
  

  <div class="kuiPanel kuiPanel--withHeader" >
    
    <div class="kuiPanelHeader">
      <div class="kuiPanelHeaderSection">
        <div class="kuiPanelHeader__title">
          Search Test Box
        </div>
      </div>
    </div>

   
    <div class="kuiTabs">
      <button
        class="kuiTab kuiTab-isSelected"
        title="Quick Search"
        ng-click="seeAutocompleteTab($event)"
        
      >
        Completion Suggester TAYG
      </button>

      <button
        class="kuiTab"
        title="Edit Script"
        ng-click="seeCustomSearchTab($event)"
       
      >
         Custom Search
      </button>
    </div>



    <div class="kuiPanelBody" ng-if="selectedTab === 1">
       <table class="kuiTable kuiTable--fluid">
          <tbody>
         
            <tr class="kuiTableRow">
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  Index Name
                </div>
              </td>
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  <input type="text" class="kuiTextInput" placeholder="Index name" ng-model="$parent.indexName">
                </div>
              </td>
            </tr>


            <tr class="kuiTableRow">
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  Type Name
                </div>
                </div>
              </td>
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  <input type="text"  class="kuiTextInput" placeholder="Type name" ng-model="$parent.typeName">
                </div>
              </td>

            </tr>



             <tr class="kuiTableRow">
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  Results per Page
                </div>
              </td>
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  <input type="text"  class="kuiTextInput" placeholder="Results per Page" ng-model="$parent.resPerPage">
                </div>
              </td>

            </tr>


            <tr class="kuiTableRow">
              <td class="kuiTableRowCell">
                <div class="kuiTableRowCell__liner">
                  Query body
                </div>
                </div>
              </td>
              <td class="kuiTableRowCell">
                <textarea type="text" class=".textsearchbox kuiTextArea" style="width: 100%" ng-model="$parent.searchQuery" required>
                </textarea>
              </td>

            </tr>

          </tbody>
       </table>
    </div>

 

    <div class="kuiPanelBody" ng-if="selectedTab === 0">
      <table class="kuiTable kuiTable--fluid">
        <tbody>
       
          <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                Index Name
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text" class="kuiTextInput" placeholder="Index name" ng-model="$parent.indexName">
              </div>
            </td>
          </tr>


          <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                Type Name
              </div>
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text"  class="kuiTextInput" placeholder="Type name" ng-model="$parent.typeName">
              </div>
            </td>

          </tr>


           <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                Suggest Field Name
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text" class="kuiTextInput" placeholder="Suggest Field" ng-model="$parent.suggestField">
              </div>
            </td>
          </tr>

          <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                Nb chars input trigger
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text" class="kuiTextInput" placeholder="min Length" ng-model="$parent.minLength">
              </div>
            </td>
          </tr>


          <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                Size
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text" class="kuiTextInput" placeholder="Response size" ng-model="$parent.pageSize">
              </div>
            </td>
          </tr>

          <tr class="kuiTableRow">
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
               Max Fuzziness 
              </div>
            </td>
            <td class="kuiTableRowCell">
              <div class="kuiTableRowCell__liner">
                <input type="text" class="kuiTextInput" placeholder="fuzziness" ng-model="$parent.fuzziness">
              </div>
            </td>
          </tr>
       
        </tbody>
      </table>
    </div>


    <div class="kuiIcon kuiIcon--error fa-warning" ng-show="apiError">
      
    </div>

<!-- RESULTS -->
    <div class="kuiPanelBody" >
      <div ng-if="selectedTab === 0">
        <div style="display: flex;" >
            <div style="margin-right: 20px;">
                <input ng-keyup="doSuggest($event)" type="text" class="kuiTextInput" placeholder="{{searchBoxHint}}" ng-model="$parent.searchStr" >
            </div>
        </div>

        <div class="searchresults" ng-if="showDropdown">
          <ul style="list-style-type:none;padding-left: 5px">
            <div ng-repeat="row in $parent.results" style="display: flex;" >

              <div style="width: 50%;">
                {{row.text}}
              </div>
              <div style="width: 10%; font-size: large;">
                {{row._score}}
              </div>
            </div>  
          </ul>
        </div>
      </div>
      <div ng-if="selectedTab === 1">

        <div class="kuiControlledTable">
          <!-- ToolBar -->
          <div class="kuiToolBar" ng-repeat="searchParam in params">

              <div class="kuiToolBarSearch">
                <div class="kuiToolBarSearchBox">
                  <div class="kuiToolBarSearchBox__icon kuiIcon fa-search"></div>
                  <input
                    class="kuiToolBarSearchBox__input"
                    type="text"
                    placeholder="enter @{{searchParam.num}} param value"
                    ng-model="searchParam.item"
                    ng-keyup="doTayg($event,searchParam.num)"

                  >
                </div>
              </div>

              <div class="kuiToolBarSection">

                <button ng-click="doSearch()" class="kuiButton kuiButton--primary">
                  Search
                </button>

                <!--button class="kuiButton kuiButton--primary" ng-click="addParam(searchParam)">
                  Add Param
                </button-->

                <!--button class="kuiButton kuiButton--primary" ng-click="removeParam(searchParam)" ng-if="searchParam.num > 0 || params.length > 1">
                  Remove Param
                </button-->

                <a  class="kuiMicroButton" title="Add Param" ng-click="addParam(searchParam)">
                    <span class="kuiIcon fa-plus"></span>
                </a>


                <a  class="kuiMicroButton" title="Remove Param" ng-click="removeParam(searchParam)" ng-if="searchParam.num > 0 || params.length > 1">
                    <span class="kuiIcon fa-minus"></span>
                </a>

               

                
              </div>

              <input type="checkbox" class="kuiCheckBox" ng-model="searchParam.tayg">
              
              <span>TAYG</span>

              <div class="kuiToolBarSection" ng-if="searchParam.num == -1">
                <div class="kuiToolBarText">
                  {{ (pageNumber * resPerPage) + 1  }} &ndash; {{ ((pageNumber+1) * resPerPage) }} of {{total}}
                </div>

                <div class="kuiButtonGroup kuiButtonGroup--united">
                  <button class="kuiButton kuiButton--basic kuiButton--icon" ng-click="prevPage()">
                    <span class="kuiButton__icon kuiIcon fa-chevron-left"></span>
                  </button>
                  <button class="kuiButton kuiButton--basic kuiButton--icon" ng-click="nextPage()">
                    <span class="kuiButton__icon kuiIcon fa-chevron-right"></span>
                  </button>
                </div>
              </div>
          </div>

         


          <div class="kuiTabs">
              <button
                class="kuiTab kuiTab-isSelected"
                title="Hits"
                ng-click="seeHitsTab($event)"
              >
                Hits
              </button>

              <button
                class="kuiTab"
                title="Suggestions"
                ng-click="seeSuggestTab($event)"
              >
                 Suggestions
              </button>
          </div>


          <div ng-if="searchTabSelected === 0">
            <!-- Field Titles-->
            <table class="kuiTable">
              <thead>
                <tr>
                 
                  <th class="kuiTableHeaderCell">
                    Responses
                  </th>
                  
                </tr>
              </thead>

              <!-- results -->
              <tbody>
                <tr class="kuiTableRow" ng-repeat="row in $parent.response.hits">
                  
                  <td class="kuiTableRowCell" >
                    
                    <json-formatter open="0" json="row._source"></json-formatter>


                  </td>

                  <td class="kuiTableRowCell" >
                    
                    <div style="font-size: large;">
                    {{row._score}}
                    <div>


                  </td>
                 
                </tr>
              </tbody>
            </table>


            <!-- ToolBarFooter -->
            <div class="kuiToolBarFooter">
              <div class="kuiToolBarFooterSection">
                <div class="kuiToolBarText">
                  {{total}} total hits found
                </div>
              </div>

              <div class="kuiToolBarFooterSection">
                <div class="kuiToolBarText">
                  {{ (pageNumber * resPerPage) + 1  }} &ndash; {{ ((pageNumber+1) * resPerPage) }} of {{total}}
                </div>

                <div class="kuiButtonGroup kuiButtonGroup--united">
                  <button class="kuiButton kuiButton--basic kuiButton--icon" ng-click="prevPage()">
                    <span class="kuiButton__icon kuiIcon fa-chevron-left"></span>
                  </button>
                  
                  <button class="kuiButton kuiButton--basic kuiButton--icon" ng-click="nextPage()">
                    <span class="kuiButton__icon kuiIcon fa-chevron-right"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>


          <div ng-if="searchTabSelected === 1">
            <!-- Field Titles-->
            <table class="kuiTable">
              <thead>
                <tr>
                 
                  <th class="kuiTableHeaderCell">
                    Suggestions
                  </th>
                  
                </tr>
              </thead>

              <!-- results TODO check highlighted -->
              <tbody>
                <tr class="kuiTableRow" ng-repeat="sugg in $parent.iterSuggesters[0]">
                  
                  <td class="kuiTableRowCell" ng-bind-html="sugg.show | trust">
                  
                  </td>
                 
                </tr>
              </tbody>
            </table>
           
          </div>


        </div>
      </div>
    </div>

  </div>
  
</div>